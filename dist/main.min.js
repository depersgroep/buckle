"use strict";function Cycle(t){function e(){var t=0;l.defaults.slides.collection.each(function(){$(this).hasClass("active")&&(l.defaults.slides.cur=t),t+=1}),l.show(l.defaults.slides.cur),l.defaults.settings.nav&&s(),l.defaults.settings.bullets&&i(),l.defaults.settings.autoplay&&(l.defaults.settings._interval=window.setInterval(function(){l.showNext(!0)},l.defaults.settings.timer))}function s(){bean.on($(".next",l.defaults.settings.nav)[0],"click",function(t){t.preventDefault(),l.showNext()}),bean.on($(".previous",l.defaults.settings.nav)[0],"click",function(t){t.preventDefault(),l.showPrevious()})}function i(){$(".slider__bullet",l.defaults.settings.bullets).each(function(){var t=arguments[1];bean.on(this,"click",function(e){e.preventDefault(),l.stopAutoplay(),l.show(t)})})}var l=this;return l.defaults={cycle:t.cycle?t.cycle:null,container:t.container?t.container:null,containerwidth:t.containerwidth?t.containerwidth:!1,slides:{collection:t.slides?t.slides:null,min:0,max:t.slidesLimit?t.slidesLimit:t.slides?t.slides.length:0,cur:t.initialSlide?t.initialSlide:0,step:t.step?t.step:1,slideWidth:t.slideWidth?t.slideWidth:0},callback:{onSlideChange:t.onSlideChange?t.onSlideChange:function(){}},settings:{nav:t.navigation?t.navigation:!1,numbers:t.numbers?t.numbers:!1,bullets:t.bullets?t.bullets:!1,autoplay:t.autoplay?t.autoplay:!1,timer:t.timer?t.timer:3e3,infinite:t.loop?t.loop:!1,animation:t.animation?t.animation:!1,_interval:null,loop:t.loop?t.loop:!1}},l.defaults.cycle&&l.defaults.slides.max&&e(),l}function Dialog(t){var e=this;return e.defaults={trigger:t.trigger?t.trigger:null,overlay:t.overlay===!1?t.overlay:!0,closer:t.close?t.close:!1,position:t.position?t.position:{x:"50%",y:"50%"},onShow:t.onShow?t.onShow:$.noop,onHide:t.onHide?t.onHide:$.noop},$(e.defaults.trigger).each(function(){var t=$(this),s=t.attr("data-trigger"),i=$('*[data-modal="'+s+'"]');s&&i.length&&(t.data("toggle",new Toggle({trigger:this,toggle:i,globalClose:!1,onShow:function(){e.show(t,i)},onHide:function(){e.hide(t,i)}})),e.defaults.closer&&$(e.defaults.closer,i).on("click.dialog.close",function(){var t=$(e.defaults.trigger).data("toggle");t&&t.hide.call(t)}))}),e}function Spotify(t){this._settings={element:t.element,url:t.url,track:t.track?t.track:null,title:t.title?t.title:"",fade:t.fade?t.fade:!1,height:t.height?t.height:80,width:t.width?t.width:"100%",bannerText:t.bannerText?t.bannerText:"DM Playlist",amount:t.recentAmount?t.recentAmount:5},this.load(this._settings.url)}function Streamer(t){var e=this;e.defaults={timestamp:moment().unix(),htmlObj:t.obj?t.obj:null,pollURL:t.url?t.url:!1,counter:t.counter?t.counter:null,timeout:t.timeout?t.timeout:30,_timeout:null,_timer:0},e.startFetching()}function Swiper(t){var e={minMoveX:20,minMoveY:20,preventDefaultEvents:t.preventDefault!==!0?t.preventDefault:!0,element:t.element,preventDownwardScroll:t.preventDownwardScroll?t.preventDownwardScroll:!1,preventUpwardScroll:t.preventUpwardScroll?t.preventUpwardScroll:!1};return this.preventDownwardScroll=function(t){e.preventDownwardScroll=t},this.preventUpwardScroll=function(t){e.preventUpwardScroll=t},$(e.element).each(function(){function t(){bean.on(this,"touchmove.swiper",s),l=null,n=!1}function s(s){if(e.preventDefaultEvents&&s.preventDefault(),n){var i=s.touches[0].pageX,o=s.touches[0].pageY,r=l-i,u=a-o;Math.abs(r)>=e.minMoveX?(t(),r>0?Arbiter.publish("/swipe/left",{element:e.element,originalEvent:s}):Arbiter.publish("/swipe/right",{element:e.element,originalEvent:s})):Math.abs(u)>=e.minMoveY&&(t(),u>0?Arbiter.publish("/swipe/up",{element:e.element,originalEvent:s}):Arbiter.publish("/swipe/down",{element:e.element,originalEvent:s})),u>0?e.preventDownwardScroll&&s.preventDefault():0>u&&e.preventUpwardScroll&&s.preventDefault()}}function i(t){1===t.touches.length&&(l=t.touches[0].pageX,a=t.touches[0].pageY,n=!0,bean.on(this,"touchmove.swiper",s))}var l,a,n=!1;bean.on(this,"touchstart.swiper",i)}),this}function Tabs(t){if(t){var e=this;this.defaults={tabs:t.tabs?t.tabs:null,mouseEvent:t.mouseEvent?t.mouseEvent:"click",onTabChange:t.onTabChange?t.onTabChange:function(){},noPreventDefault:t.noPreventDefault?t.noPreventDefault:!1},$(this.defaults.tabs).each(function(){var t=$(this),s=t.attr("aria-controls");s&&t.data("toggle",new Toggle({trigger:t,toggle:$("#"+s),mouseEvent:e.defaults.mouseEvent,globalClose:!1,toggleClick:!1,onShow:function(){e.show(t)},noPreventDefault:e.defaults.noPreventDefault}))})}return this}function Toggle(t){var e=this;return t&&(this.defaults={toggle:t.toggle?t.toggle:null,trigger:t.trigger?t.trigger:null,state:t.state?t.state:!1,globalClose:t.globalClose===!1?t.globalClose:!0,noPreventDefault:t.noPreventDefault?t.noPreventDefault:!1,toggleClick:t.toggleClick===!1?t.toggleClick:!0,mouseEvent:t.mouseEvent?t.mouseEvent:"click",onShow:t.onShow?t.onShow:function(){},onHide:t.onHide?t.onHide:function(){},onToggle:t.onToggle?t.onToggle:function(){}},this.defaults.toggle&&this.defaults.trigger&&("hover"===this.defaults.mouseEvent?$(this.defaults.trigger).on("mouseover.toggle mouseout.toggle",function(){e.toggle()}):$(this.defaults.trigger).on("click.toggle.trigger",function(t){e.defaults.noPreventDefault||t.preventDefault(),e.toggle()})),this.defaults.state&&this.show()),this}function Validate(t){if(t){var e=this;e.defaults={frm:t.frm?t.frm:!1,fields:[]},e.defaults.frm&&(e.defaults.frm.setAttribute("novalidate",""),$("input[required], textarea[required], select[required]",e.defaults.frm).each(function(){e.defaults.fields.push({hasError:!1,htmlObj:this})}),bean.on(e.defaults.frm,"submit",function(t){e.checkValidation()?t.preventDefault():$('[type="submit"]',this).attr("disabled","disabled")}),bean.on(e.defaults.frm,"reset",function(){e.removeAllErrors()}))}return this}Cycle.prototype.show=function(t,e){var s=!1,i=e?e:!1;if(""!==t&&(t>=0&&t<this.defaults.slides.max?s=!0:0>t?this.defaults.settings.infinite&&(s=!0,t=this.defaults.slides.max-this.defaults.slides.step):t>=this.defaults.slides.max&&this.defaults.settings.infinite&&(s=!0,t=0),s)){i||"slide"!==this.defaults.settings.animation||(i="left",t<this.defaults.slides.cur&&(i="right")),this.defaults.slides.cur=t;var l={container:this.defaults.container,containerwidth:this.defaults.containerwidth,slides:this.defaults.slides.collection,slideWidth:this.defaults.slides.slideWidth,slideNumber:this.defaults.slides.cur,slideMax:this.defaults.slides.max,slideStep:this.defaults.slides.step,animation:this.defaults.settings.animation,direction:i,bullets:this.defaults.settings.bullets,infinite:this.defaults.settings.infinite,navigation:this.defaults.settings.nav};this.defaults.callback.onSlideChange.call(this,l)}return this},Cycle.prototype.showNext=function(t){var e=0;return this.stopAutoplay(t),this.defaults.settings.loop||this.defaults.slides.cur+2*this.defaults.slides.step<=this.defaults.slides.max?e=this.defaults.slides.cur+this.defaults.slides.step:(e=this.defaults.slides.cur+this.defaults.slides.max,e-=this.defaults.slides.cur+this.defaults.slides.step),this.show(e,"left"),this},Cycle.prototype.showPrevious=function(t){var e=0;return this.stopAutoplay(t),(this.defaults.settings.loop||this.defaults.slides.cur-this.defaults.slides.step>-1)&&(e=this.defaults.slides.cur-this.defaults.slides.step),this.show(e,"right"),this},Cycle.prototype.startAutoplay=function(t){var e=this;this.isPlaying=!0,t=t||this.defaults.settings.timer,t&&!this.defaults.settings.autoplay&&(this.defaults.settings.autoplay=!0,this.defaults.settings._interval=window.setInterval(function(){e.showNext(!0)},this.defaults.settings.timer))},Cycle.prototype.stopAutoplay=function(t){if(this.isPlaying=!1,!t&&this.defaults.settings.autoplay&&this.defaults.settings._interval){var e=this.defaults.settings._interval;window.clearInterval(e),this.defaults.settings.autoplay=!1}},Dialog.prototype.show=function(t,e){App.views.dialog.unshift($(this.defaults.trigger).data("toggle")),this.defaults.onShow.call(this,{overlay:this.defaults.overlay,modal:e,trigger:t,position:this.defaults.position})},Dialog.prototype.hide=function(t,e){App.views.dialog.length&&App.views.dialog.shift(),this.defaults.onHide.call(this,{overlay:this.defaults.overlay,modal:e,trigger:t,position:this.defaults.position})},Spotify.prototype.load=function(t){var e,s=this,i="onreadystatechange";window.XDomainRequest?(e=new window.XDomainRequest,i="onload",e.onprogress=function(){}):e=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e[i]=function(){if(4===e.readyState&&(200===e.status||304===e.status)||"onload"===i){var l=JSON.parse(e.responseText);""===s._settings.title&&"undefined"!=typeof l.playlist&&(s._settings.title=l.playlist.title),s._settings.track||s.setTrack(l.tracks[0].id),Arbiter.publish("/spotify/load/success",{url:t,response:l,settings:{url:s._settings.url,element:s._settings.element,title:s._settings.title,height:s._settings.height,width:s._settings.width,amount:s._settings.amount,bannerText:s._settings.bannerText,track:s._settings.track,fade:s._settings.fade}})}},e.open("GET",t),e.send()},Spotify.prototype.setTrack=function(t){this._settings.track=t,Arbiter.publish("/spotify/track/select",{track:t,element:this._settings.element})},Streamer.prototype.startFetching=function(){var t=this;this.defaults._timer=this.defaults.timeout,Arbiter.publish("streamer/timer/update",{htmlObj:this.defaults.counter,timer:this.defaults._timer}),this.defaults._timeout=window.setInterval(function(){t.gogoTimer()},1e3)},Streamer.prototype.gogoTimer=function(){var t=this;this.defaults._timer>0?(this.defaults._timer--,Arbiter.publish("streamer/timer/update",{htmlObj:this.defaults.counter,timer:this.defaults._timer})):(window.clearInterval(t.defaults._timeout),this.fetch())},Streamer.prototype.fetch=function(){var t=this;reqwest({url:t.defaults.pollURL+"?timestamp="+t.defaults.timestamp,type:"json",success:function(e){e.response&&e.timestamp&&e.timestamp>t.defaults.timestamp&&(Arbiter.publish("streamer/fetchupdate",{htmlObj:t.defaults.htmlObj,updateURL:e.response}),t.defaults.timestamp=e.timestamp),t.startFetching()}})},Tabs.prototype.show=function(t){if(t&&this.defaults){var e=this;$(this.defaults.tabs).each(function(){e.hide($(this))}),Arbiter.publish("/tabs/show",{tab:t,pane:$("#"+t.attr("aria-controls"))}),e.defaults.onTabChange.call(e)}return this},Tabs.prototype.hide=function(t){return t&&this.defaults&&(t.data("toggle").hide(),Arbiter.publish("/tabs/hide",{tab:t,pane:$("#"+t.attr("aria-controls"))})),this},Tabs.prototype.destroy=function(){return this.defaults&&$(this.defaults.tabs).each(function(){var t=$(this);t.data("toggle")&&(t.data("toggle").destroy(),t.data("toggle",""))}),this},Toggle.prototype.toggle=function(){return this.defaults&&(this.defaults.toggleClick&&this.defaults.state?this.hide():this.show(),this.defaults.onToggle.call(this.defaults.toggle)),this},Toggle.prototype.show=function(){return this.defaults&&(this.defaults.state=!0,Arbiter.publish("/toggle/show",{toggle:this.defaults.toggle}),this.defaults.globalClose&&$(document).on("click.toggle.globalclose",function(t,e){var s=e._this,i=$(s.defaults.toggle)[0].contains(t.target)||$(s.defaults.toggle)[0]===t.target,l=$(s.defaults.trigger)[0].contains(t.target)||$(s.defaults.trigger)[0]===t.target;i||l||s.hide(!0)},{_this:this}),this.defaults.onShow.call(this.defaults.toggle)),this},Toggle.prototype.hide=function(){return this.defaults&&(this.defaults.state=!1,Arbiter.publish("/toggle/hide",{toggle:this.defaults.toggle}),this.defaults.onHide.call(this.defaults.toggle),this.defaults.globalClose&&$(document).off("click.toggle.globalclose",this.hide)),this},Toggle.prototype.destroy=function(){var t=this;return this.defaults&&(Arbiter.publish("/toggle/destroy",this.defaults),$(t.defaults.trigger).off("click.toggle mouseover.toggle mouseout.toggle"),$(document).off("click.toggle",this.hide),this.defaults=null),this},Validate.prototype.checkValidation=function(){var t=!1;if(this.defaults){for(var e in this.defaults.fields)if(this.defaults.fields[e]&&this.defaults.fields[e].htmlObj)if(this.removeError(e),this.checkValue(this.defaults.fields[e].htmlObj))switch(this.defaults.fields[e].htmlObj.nodeName.toLowerCase()){case"textarea":break;case"select":break;default:switch(this.defaults.fields[e].htmlObj.getAttribute("type")){case"checkbox":this.defaults.fields[e].htmlObj.checked?bean.off(this):(this.triggerError(e,"unchecked"),t=!0);break;case"radio":var s=$('input[name="'+this.defaults.fields[e].htmlObj.name+'"]:checked');(s.length<1||!s[0].value)&&(this.triggerError(e,"unchecked"),t=!0);break;case"tel":break;case"email":/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(this.defaults.fields[e].htmlObj.value)||(this.triggerError(e,"invalidEmail"),t=!0)}}else this.triggerError(e,"empty"),t=!0;Arbiter.publish("/validate/complete",{error:t,validate:this,frm:this.defaults.frm})}return t},Validate.prototype.checkValue=function(t){var e=!1;return t&&t.value&&t.value!==t.getAttribute("placeholder")&&(t.getAttribute("minlength")?t.value.length>=parseInt(t.getAttribute("minlength"),10)&&(e=!0):e=!0),e},Validate.prototype.triggerError=function(t,e){if((t||0===t)&&e){var s=this;if("number"!=typeof t&&!this.defaults.fields[t]){"string"==typeof t&&(t=$(t,s.defaults.frm));for(var i=0;i<this.defaults.fields.length;i++)if(t[0]===this.defaults.fields[i].htmlObj){t=i;break}}this.defaults.fields[t].hasError=!0,bean.off(s.defaults.fields[t].htmlObj,"keyup.validate"),bean.on(s.defaults.fields[t].htmlObj,"keyup.validate",function(){s.checkValidation()}),Arbiter.publish("/validate/error/show",{field:this.defaults.fields[t].htmlObj,message:App.config.formErrors[e]})}return this},Validate.prototype.removeError=function(t){if(t){if("number"!=typeof t&&!this.defaults.fields[t]){"string"==typeof t&&(t=$(t,this.defaults.frm));for(var e=0;e<this.defaults.fields.length;e++)if(t[0]===this.defaults.fields[e].htmlObj){t=e;break}}Arbiter.publish("/validate/error/remove",{field:this.defaults.fields[t].htmlObj})}return this},Validate.prototype.removeAllErrors=function(){for(var t in this.defaults.fields)this.defaults.fields[t]&&this.defaults.fields[t].htmlObj&&(bean.off(this.defaults.fields[t].htmlObj,"keyup.validate"),this.removeError(t))};