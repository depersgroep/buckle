!function(name,context,definition){"undefined"!=typeof module&&module.exports?module.exports=definition():"function"==typeof define&&define.amd?define(definition):context[name]=definition()}("bonzo",this,function(){function isNode(node){return node&&node.nodeName&&(1==node.nodeType||11==node.nodeType)}function normalize(node,host,clone){var i,l,ret;if("string"==typeof node)return bonzo.create(node);if(isNode(node)&&(node=[node]),clone){for(ret=[],i=0,l=node.length;l>i;i++)ret[i]=cloneNode(host,node[i]);return ret}return node}function classReg(c){return new RegExp("(^|\\s+)"+c+"(\\s+|$)")}function each(ar,fn,opt_scope,opt_rev){for(var ind,i=0,l=ar.length;l>i;i++)ind=opt_rev?ar.length-i-1:i,fn.call(opt_scope||ar[ind],ar[ind],ind,ar);return ar}function deepEach(ar,fn,opt_scope){for(var i=0,l=ar.length;l>i;i++)isNode(ar[i])&&(deepEach(ar[i].childNodes,fn,opt_scope),fn.call(opt_scope||ar[i],ar[i],i,ar));return ar}function camelize(s){return s.replace(/-(.)/g,function(m,m1){return m1.toUpperCase()})}function decamelize(s){return s?s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase():s}function data(el){el[getAttribute]("data-node-uid")||el[setAttribute]("data-node-uid",++uuids);var uid=el[getAttribute]("data-node-uid");return uidMap[uid]||(uidMap[uid]={})}function clearData(el){var uid=el[getAttribute]("data-node-uid");uid&&delete uidMap[uid]}function dataValue(d){var f;try{return null===d||void 0===d?void 0:"true"===d?!0:"false"===d?!1:"null"===d?null:(f=parseFloat(d))==d?f:d}catch(e){}return void 0}function some(ar,fn,opt_scope){for(var i=0,j=ar.length;j>i;++i)if(fn.call(opt_scope||null,ar[i],i,ar))return!0;return!1}function styleProperty(p){return"transform"==p&&(p=features.transform)||/^transform-?[Oo]rigin$/.test(p)&&(p=features.transform+"Origin")||"float"==p&&(p=features.cssFloat),p?camelize(p):null}function insert(target,host,fn,rev){var i=0,self=host||this,r=[],nodes=query&&"string"==typeof target&&"<"!=target.charAt(0)?query(target):target;return each(normalize(nodes),function(t,j){each(self,function(el){fn(t,r[i++]=j>0?cloneNode(self,el):el)},null,rev)},this,rev),self.length=i,each(r,function(e){self[--i]=e},null,!rev),self}function xy(el,x,y){var $el=bonzo(el),style=$el.css("position"),offset=$el.offset(),rel="relative",isRel=style==rel,delta=[parseInt($el.css("left"),10),parseInt($el.css("top"),10)];"static"==style&&($el.css("position",rel),style=rel),isNaN(delta[0])&&(delta[0]=isRel?0:el.offsetLeft),isNaN(delta[1])&&(delta[1]=isRel?0:el.offsetTop),null!=x&&(el.style.left=x-offset.left+delta[0]+px),null!=y&&(el.style.top=y-offset.top+delta[1]+px)}function setter(el,v){return"function"==typeof v?v.call(el,el):v}function scroll(x,y,type){var el=this[0];return el?null==x&&null==y?(isBody(el)?getWindowScroll():{x:el.scrollLeft,y:el.scrollTop})[type]:(isBody(el)?win.scrollTo(x,y):(null!=x&&(el.scrollLeft=x),null!=y&&(el.scrollTop=y)),this):this}function Bonzo(elements){if(this.length=0,elements){elements="string"==typeof elements||elements.nodeType||"undefined"==typeof elements.length?[elements]:elements,this.length=elements.length;for(var i=0;i<elements.length;i++)this[i]=elements[i]}}function cloneNode(host,el){var cloneElems,elElems,i,c=el.cloneNode(!0);if(host.$&&"function"==typeof host.cloneEvents)for(host.$(c).cloneEvents(el),cloneElems=host.$(c).find("*"),elElems=host.$(el).find("*"),i=0;i<elElems.length;i++)host.$(cloneElems[i]).cloneEvents(elElems[i]);return c}function isBody(element){return element===win||/^(?:body|html)$/i.test(element.tagName)}function getWindowScroll(){return{x:win.pageXOffset||html.scrollLeft,y:win.pageYOffset||html.scrollTop}}function createScriptFromHtml(html){var scriptEl=document.createElement("script"),matches=html.match(simpleScriptTagRe);return scriptEl.src=matches[1],scriptEl}function bonzo(els){return new Bonzo(els)}var hasClass,addClass,removeClass,win=window,doc=win.document,html=doc.documentElement,parentNode="parentNode",specialAttributes=/^(checked|value|selected|disabled)$/i,specialTags=/^(select|fieldset|table|tbody|tfoot|td|tr|colgroup)$/i,simpleScriptTagRe=/\s*<script +src=['"]([^'"]+)['"]>/,table=["<table>","</table>",1],td=["<table><tbody><tr>","</tr></tbody></table>",3],option=["<select>","</select>",1],noscope=["_","",0,1],tagMap={thead:table,tbody:table,tfoot:table,colgroup:table,caption:table,tr:["<table><tbody>","</tbody></table>",2],th:td,td:td,col:["<table><colgroup>","</colgroup></table>",2],fieldset:["<form>","</form>",1],legend:["<form><fieldset>","</fieldset></form>",2],option:option,optgroup:option,script:noscope,style:noscope,link:noscope,param:noscope,base:noscope},stateAttributes=/^(checked|selected|disabled)$/,ie=/msie/i.test(navigator.userAgent),uidMap={},uuids=0,digit=/^-?[\d\.]+$/,dattr=/^data-(.+)$/,px="px",setAttribute="setAttribute",getAttribute="getAttribute",byTag="getElementsByTagName",features=function(){var e=doc.createElement("p");return e.innerHTML='<a href="#x">x</a><table style="float:left;"></table>',{hrefExtended:"#x"!=e[byTag]("a")[0][getAttribute]("href"),autoTbody:0!==e[byTag]("tbody").length,computedStyle:doc.defaultView&&doc.defaultView.getComputedStyle,cssFloat:e[byTag]("table")[0].style.styleFloat?"styleFloat":"cssFloat",transform:function(){var i,props=["transform","webkitTransform","MozTransform","OTransform","msTransform"];for(i=0;i<props.length;i++)if(props[i]in e.style)return props[i]}(),classList:"classList"in e,opasity:function(){return"undefined"!=typeof doc.createElement("a").style.opacity}()}}(),trimReplace=/(^\s*|\s*$)/g,whitespaceRegex=/\s+/,toString=String.prototype.toString,unitless={lineHeight:1,zoom:1,zIndex:1,opacity:1,boxFlex:1,WebkitBoxFlex:1,MozBoxFlex:1},query=doc.querySelectorAll&&function(selector){return doc.querySelectorAll(selector)},trim=String.prototype.trim?function(s){return s.trim()}:function(s){return s.replace(trimReplace,"")},getStyle=features.computedStyle?function(el,property){var value=null,computed=doc.defaultView.getComputedStyle(el,"");return computed&&(value=computed[property]),el.style[property]||value}:ie&&html.currentStyle?function(el,property){var val,value;if("opacity"==property&&!features.opasity){val=100;try{val=el.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e1){try{val=el.filters("alpha").opacity}catch(e2){}}return val/100}return value=el.currentStyle?el.currentStyle[property]:null,el.style[property]||value}:function(el,property){return el.style[property]};return features.classList?(hasClass=function(el,c){return el.classList.contains(c)},addClass=function(el,c){el.classList.add(c)},removeClass=function(el,c){el.classList.remove(c)}):(hasClass=function(el,c){return classReg(c).test(el.className)},addClass=function(el,c){el.className=trim(el.className+" "+c)},removeClass=function(el,c){el.className=trim(el.className.replace(classReg(c)," "))}),Bonzo.prototype={get:function(index){return this[index]||null},each:function(fn,opt_scope){return each(this,fn,opt_scope)},deepEach:function(fn,opt_scope){return deepEach(this,fn,opt_scope)},map:function(fn,opt_reject){var n,i,m=[];for(i=0;i<this.length;i++)n=fn.call(this,this[i],i),opt_reject?opt_reject(n)&&m.push(n):m.push(n);return m},html:function(h,opt_text){var method=opt_text?void 0===html.textContent?"innerText":"textContent":"innerHTML",that=this,append=function(el,i){each(normalize(h,that,i),function(node){el.appendChild(node)})},updateElement=function(el,i){try{if(opt_text||"string"==typeof h&&!specialTags.test(el.tagName))return el[method]=h}catch(e){}append(el,i)};return"undefined"!=typeof h?this.empty().each(updateElement):this[0]?this[0][method]:""},text:function(opt_text){return this.html(opt_text,!0)},append:function(node){var that=this;return this.each(function(el,i){each(normalize(node,that,i),function(i){el.appendChild(i)})})},prepend:function(node){var that=this;return this.each(function(el,i){var first=el.firstChild;each(normalize(node,that,i),function(i){el.insertBefore(i,first)})})},appendTo:function(target,opt_host){return insert.call(this,target,opt_host,function(t,el){t.appendChild(el)})},prependTo:function(target,opt_host){return insert.call(this,target,opt_host,function(t,el){t.insertBefore(el,t.firstChild)},1)},before:function(node){var that=this;return this.each(function(el,i){each(normalize(node,that,i),function(i){el[parentNode].insertBefore(i,el)})})},after:function(node){var that=this;return this.each(function(el,i){each(normalize(node,that,i),function(i){el[parentNode].insertBefore(i,el.nextSibling)},null,1)})},insertBefore:function(target,opt_host){return insert.call(this,target,opt_host,function(t,el){t[parentNode].insertBefore(el,t)})},insertAfter:function(target,opt_host){return insert.call(this,target,opt_host,function(t,el){var sibling=t.nextSibling;sibling?t[parentNode].insertBefore(el,sibling):t[parentNode].appendChild(el)},1)},replaceWith:function(node){return bonzo(this[0].parentNode.replaceChild(bonzo(normalize(node))[0],this[0]))},clone:function(opt_host){var l,i,ret=[];for(i=0,l=this.length;l>i;i++)ret[i]=cloneNode(opt_host||this,this[i]);return bonzo(ret)},addClass:function(c){return c=toString.call(c).split(whitespaceRegex),this.each(function(el){each(c,function(c){c&&!hasClass(el,setter(el,c))&&addClass(el,setter(el,c))})})},removeClass:function(c){return c=toString.call(c).split(whitespaceRegex),this.each(function(el){each(c,function(c){c&&hasClass(el,setter(el,c))&&removeClass(el,setter(el,c))})})},hasClass:function(c){return c=toString.call(c).split(whitespaceRegex),some(this,function(el){return some(c,function(c){return c&&hasClass(el,c)})})},toggleClass:function(c,opt_condition){return c=toString.call(c).split(whitespaceRegex),this.each(function(el){each(c,function(c){c&&("undefined"!=typeof opt_condition?opt_condition?!hasClass(el,c)&&addClass(el,c):removeClass(el,c):hasClass(el,c)?removeClass(el,c):addClass(el,c))})})},show:function(opt_type){return opt_type="string"==typeof opt_type?opt_type:"",this.each(function(el){el.style.display=opt_type})},hide:function(){return this.each(function(el){el.style.display="none"})},toggle:function(opt_callback,opt_type){return opt_type="string"==typeof opt_type?opt_type:"","function"!=typeof opt_callback&&(opt_callback=null),this.each(function(el){el.style.display=el.offsetWidth||el.offsetHeight?"none":opt_type,opt_callback&&opt_callback.call(el)})},first:function(){return bonzo(this.length?this[0]:[])},last:function(){return bonzo(this.length?this[this.length-1]:[])},next:function(){return this.related("nextSibling")},previous:function(){return this.related("previousSibling")},parent:function(){return this.related(parentNode)},related:function(method){return bonzo(this.map(function(el){for(el=el[method];el&&1!==el.nodeType;)el=el[method];return el||0},function(el){return el}))},focus:function(){return this.length&&this[0].focus(),this},blur:function(){return this.length&&this[0].blur(),this},css:function(o,opt_v){function fn(el,p,v){for(var k in iter)if(iter.hasOwnProperty(k)){v=iter[k],(p=styleProperty(k))&&digit.test(v)&&!(p in unitless)&&(v+=px);try{el.style[p]=setter(el,v)}catch(e){}}}var p,iter=o;return void 0===opt_v&&"string"==typeof o?(opt_v=this[0],opt_v?opt_v===doc||opt_v===win?(p=opt_v===doc?bonzo.doc():bonzo.viewport(),"width"==o?p.width:"height"==o?p.height:""):(o=styleProperty(o))?getStyle(opt_v,o):null:null):("string"==typeof o&&(iter={},iter[o]=opt_v),!features.opasity&&"opacity"in iter&&(iter.filter=null!=iter.opacity&&""!==iter.opacity?"alpha(opacity="+100*iter.opacity+")":"",iter.zoom=o.zoom||1,delete iter.opacity),this.each(fn))},offset:function(opt_x,opt_y){if(opt_x&&"object"==typeof opt_x&&("number"==typeof opt_x.top||"number"==typeof opt_x.left))return this.each(function(el){xy(el,opt_x.left,opt_x.top)});if("number"==typeof opt_x||"number"==typeof opt_y)return this.each(function(el){xy(el,opt_x,opt_y)});if(!this[0])return{top:0,left:0,height:0,width:0};var el=this[0],de=el.ownerDocument.documentElement,bcr=el.getBoundingClientRect(),scroll=getWindowScroll(),width=el.offsetWidth,height=el.offsetHeight,top=bcr.top+scroll.y-Math.max(0,de&&de.clientTop,doc.body.clientTop),left=bcr.left+scroll.x-Math.max(0,de&&de.clientLeft,doc.body.clientLeft);return{top:top,left:left,height:height,width:width}},dim:function(){if(!this.length)return{height:0,width:0};var el=this[0],de=9==el.nodeType&&el.documentElement,orig=de||!el.style||el.offsetWidth||el.offsetHeight?null:function(t){var s={position:el.style.position||"",visibility:el.style.visibility||"",display:el.style.display||""};return t.first().css({position:"absolute",visibility:"hidden",display:"block"}),s}(this),width=de?Math.max(el.body.scrollWidth,el.body.offsetWidth,de.scrollWidth,de.offsetWidth,de.clientWidth):el.offsetWidth,height=de?Math.max(el.body.scrollHeight,el.body.offsetHeight,de.scrollHeight,de.offsetHeight,de.clientHeight):el.offsetHeight;return orig&&this.first().css(orig),{height:height,width:width}},attr:function(k,opt_v){var n,el=this[0];if("string"!=typeof k&&!(k instanceof String)){for(n in k)k.hasOwnProperty(n)&&this.attr(n,k[n]);return this}return"undefined"==typeof opt_v?el?specialAttributes.test(k)?stateAttributes.test(k)&&"string"==typeof el[k]?!0:el[k]:"href"!=k&&"src"!=k||!features.hrefExtended?el[getAttribute](k):el[getAttribute](k,2):null:this.each(function(el){specialAttributes.test(k)?el[k]=setter(el,opt_v):el[setAttribute](k,setter(el,opt_v))})},removeAttr:function(k){return this.each(function(el){stateAttributes.test(k)?el[k]=!1:el.removeAttribute(k)})},val:function(s){return"string"==typeof s||"number"==typeof s?this.attr("value",s):this.length?this[0].value:null},data:function(opt_k,opt_v){var o,m,el=this[0];return"undefined"==typeof opt_v?el?(o=data(el),"undefined"==typeof opt_k?(each(el.attributes,function(a){(m=(""+a.name).match(dattr))&&(o[camelize(m[1])]=dataValue(a.value))}),o):("undefined"==typeof o[opt_k]&&(o[opt_k]=dataValue(this.attr("data-"+decamelize(opt_k)))),o[opt_k])):null:this.each(function(el){data(el)[opt_k]=opt_v})},remove:function(){return this.deepEach(clearData),this.detach()},empty:function(){return this.each(function(el){for(deepEach(el.childNodes,clearData);el.firstChild;)el.removeChild(el.firstChild)})},detach:function(){return this.each(function(el){el[parentNode]&&el[parentNode].removeChild(el)})},scrollTop:function(y){return scroll.call(this,null,y,"y")},scrollLeft:function(x){return scroll.call(this,x,null,"x")}},bonzo.setQueryEngine=function(q){query=q,delete bonzo.setQueryEngine},bonzo.aug=function(o,target){for(var k in o)o.hasOwnProperty(k)&&((target||Bonzo.prototype)[k]=o[k])},bonzo.create=function(node){return"string"==typeof node&&""!==node?function(){if(simpleScriptTagRe.test(node))return[createScriptFromHtml(node)];var tag=node.match(/^\s*<([^\s>]+)/),el=doc.createElement("div"),els=[],p=tag?tagMap[tag[1].toLowerCase()]:null,dep=p?p[2]+1:1,ns=p&&p[3],pn=parentNode,tb=features.autoTbody&&p&&"<table>"==p[0]&&!/<tbody/i.test(node);for(el.innerHTML=p?p[0]+node+p[1]:node;dep--;)el=el.firstChild;ns&&el&&1!==el.nodeType&&(el=el.nextSibling);do tag&&1!=el.nodeType||tb&&(!el.tagName||"TBODY"==el.tagName)||els.push(el);while(el=el.nextSibling);return each(els,function(el){el[pn]&&el[pn].removeChild(el)}),els}():isNode(node)?[node.cloneNode(!0)]:[]},bonzo.doc=function(){var vp=bonzo.viewport();return{width:Math.max(doc.body.scrollWidth,html.scrollWidth,vp.width),height:Math.max(doc.body.scrollHeight,html.scrollHeight,vp.height)}},bonzo.firstChild=function(el){for(var e,c=el.childNodes,i=0,j=c&&c.length||0;j>i;i++)1===c[i].nodeType&&(e=c[j=i]);return e},bonzo.viewport=function(){return{width:ie?html.clientWidth:win.innerWidth,height:ie?html.clientHeight:win.innerHeight}},bonzo.isAncestor="compareDocumentPosition"in html?function(container,element){return 16==(16&container.compareDocumentPosition(element))}:"contains"in html?function(container,element){return container!==element&&container.contains(element)}:function(container,element){for(;element=element[parentNode];)if(element===container)return!0;return!1},bonzo});