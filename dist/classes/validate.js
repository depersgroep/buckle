"use strict";function Validate(e){if(e){var t=this;t.defaults={frm:e.frm?e.frm:!1,fields:[],noFormevents:e.noFormevents?!0:!1,i18n:{empty:e.i18n&&e.i18n.empty?e.i18n.empty:"This field is required.",unchecked:e.i18n&&e.i18n.unchecked?e.i18n.unchecked:"This field is required.",invalidEmail:e.i18n&&e.i18n.invalidEmail?e.i18n.invalidEmail:"Please enter a valid email address.",invalidTelephone:e.i18n&&e.i18n.invalidTelephone?e.i18n.invalidTelephone:"Please enter a valid telephone number."}},t.defaults.frm&&(t.defaults.frm.setAttribute("novalidate",""),$('input[required], textarea[required], select[required], input[data-validate="true"], textarea[data-validate="true"], select[data-validate="true"]',t.defaults.frm).each(function(){t.defaults.fields.push({hasError:!1,htmlObj:this})}),t.defaults.noFormevents||(bean.on(t.defaults.frm,"submit",function(e){t.checkValidation()?e.preventDefault():$('[type="submit"]',this).attr("disabled","disabled")}),bean.on(t.defaults.frm,"reset",function(){t.removeAllErrors()})))}return this}Validate.prototype.checkValidation=function(){var e=!1;function t(e){var t=e.lastIndexOf("/"),i=e.substring(1,t),l=e.substring(t+1);try{return new RegExp(i,l),{regex:i,flags:l}}catch(s){return{}}}if(this.defaults){for(var i in this.defaults.fields)if(this.defaults.fields[i]&&this.defaults.fields[i].htmlObj)if(this.removeError(i),this.checkValue(this.defaults.fields[i].htmlObj)){var l,s,a;switch(this.defaults.fields[i].htmlObj.nodeName.toLowerCase()){case"textarea":this.defaults.fields[i].htmlObj.getAttribute("data-regex")&&(l=t(this.defaults.fields[i].htmlObj.getAttribute("data-regex")),l.regex&&(s=new RegExp(l.regex,l.flags),s.test(this.defaults.fields[i].htmlObj.value)||(this.triggerError(i,"invalid"),e=!0)));break;case"select":this.defaults.fields[i].htmlObj.options[this.defaults.fields[i].htmlObj.selectedIndex].value||(this.triggerError(i,"invalid"),e=!0);break;default:switch(this.defaults.fields[i].htmlObj.getAttribute("type")){case"checkbox":this.defaults.fields[i].htmlObj.checked?bean.off(this):(this.triggerError(i,"unchecked"),e=!0);break;case"radio":a=$('input[name="'+this.defaults.fields[i].htmlObj.name+'"]:checked'),(a.length<1||!a[0].value)&&(this.triggerError(i,"unchecked"),e=!0);break;case"tel":/^(\+?\d+)(\/?[\s\.]?\d+)*$/.test(this.defaults.fields[i].htmlObj.value)||(this.triggerError(i,"invalidTelephone"),e=!0);break;case"email":/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(this.defaults.fields[i].htmlObj.value)||(this.triggerError(i,"invalidEmail"),e=!0);break;default:this.defaults.fields[i].htmlObj.getAttribute("data-regex")&&(l=t(this.defaults.fields[i].htmlObj.getAttribute("data-regex")),l.regex&&(s=new RegExp(l.regex,l.flags),s.test(this.defaults.fields[i].htmlObj.value)||(this.triggerError(i,"invalid"),e=!0)))}}}else this.defaults.fields[i].htmlObj.getAttribute("data-validate")||(this.triggerError(i,"empty"),e=!0);Arbiter.publish("/validate/complete",{error:e,validate:this,frm:this.defaults.frm})}return e},Validate.prototype.checkValue=function(e){var t=!1;return e&&e.value&&e.value!==e.getAttribute("placeholder")&&(e.getAttribute("minlength")?e.value.length>=parseInt(e.getAttribute("minlength"),10)&&(t=!0):t=!0),t},Validate.prototype.triggerError=function(e,t){if((e||0===e)&&t){var i=this;if("number"!=typeof e&&!this.defaults.fields[e]){"string"==typeof e&&(e=$(e,i.defaults.frm));for(var l=0;l<this.defaults.fields.length;l++)if(e[0]===this.defaults.fields[l].htmlObj){e=l;break}}this.defaults.fields[e].hasError=!0,bean.off(i.defaults.fields[e].htmlObj,"keyup.validate"),bean.on(i.defaults.fields[e].htmlObj,"keyup.validate",function(){i.checkValidation()}),Arbiter.publish("/validate/error/show",{field:this.defaults.fields[e].htmlObj,message:this.defaults.i18n[t]})}return this},Validate.prototype.removeError=function(e){if(e){if("number"!=typeof e&&!this.defaults.fields[e]){"string"==typeof e&&(e=$(e,this.defaults.frm));for(var t=0;t<this.defaults.fields.length;t++)if(e[0]===this.defaults.fields[t].htmlObj){e=t;break}}Arbiter.publish("/validate/error/remove",{field:this.defaults.fields[e].htmlObj})}return this},Validate.prototype.removeAllErrors=function(){for(var e in this.defaults.fields)this.defaults.fields[e]&&this.defaults.fields[e].htmlObj&&(bean.off(this.defaults.fields[e].htmlObj,"keyup.validate"),this.removeError(e))};